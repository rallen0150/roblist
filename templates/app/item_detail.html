{% extends 'base.html' %}

{% block content %}
<br><br>
  <div class="row">
    <div class="col-md-6">
      <h1>{{ item }}</h1>
      <img src="{{ MEDIA_URL}}{{ item.image_url }}" class='rounded mx-auto d-block' alt="Picture of {{ item.name }}" /> <br>
      <p>
        {{ item.description }} <br>
        {% if item.price %}
          ${{ item.price|floatformat:2 }}
        {% endif %}
      </p>
      <hr>
      <b><i>By: {{ item.user }}</i></b><br>
      <b><i>Posted On: {{ item.time_added }}</i></b>
    </div>
    <div class="col-md-6 ">
      {% comment %}
      <a href="{% url 'comment_create_view' item.id %}">Comment</a>
      {% endcomment %}
      <form class="" action="{% url 'comment_create_view' item.id %}" method="post">
        {% csrf_token %}
        <textarea name="comment" rows="20" cols="65"></textarea>
        <input type="submit" name="" value="Comment!">
      </form>
    </div>
    {% for comment in item.get_comment %}
      <div class="col-md-6 col-md-offset-6">
        <h1>{{ comment.comment }}</h1>
        <blockquote>
          Commenter: {{ comment.user }} <br>
          Time: {{ comment.time }}
        </blockquote>
        <button class="accordion">Reply</button>
        <div class="panel">
          <p>
            <form class="" action="{% url 'reply_create_view' comment.id %}" method="post">
              {% csrf_token %}
              <textarea name="reply" rows="4" cols="35"></textarea>
              <input type="submit" name="" value="Reply!">
            </form>
          </p>
        </div>
          {% for reply in comment.get_reply %}
            <blockquote>
              <h3>{{ reply.reply }}</h3>
              <blockquote>
                Reply By: {{ reply.user }}<br>
                Time: {{ reply.time }}
              </blockquote>
            </blockquote>
          {% endfor %}
      </div>
    </div>

    <script>
      var acc = document.getElementsByClassName("accordion");
      var i;

      for (i = 0; i < acc.length; i++) {
        acc[i].onclick = function() {
          this.classList.toggle("active");
          var panel = this.nextElementSibling;
          if (panel.style.maxHeight){
            panel.style.maxHeight = null;
          } else {
            panel.style.maxHeight = panel.scrollHeight + "px";
          }
        }
      }
      </script>
  {% endfor %}
{% endblock %}
